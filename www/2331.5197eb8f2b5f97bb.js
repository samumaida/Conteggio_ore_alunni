"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2331],{2331:(N,g,c)=>{c.r(g),c.d(g,{HomePageModule:()=>M});var d=c(177),a=c(4742),u=c(4341),_=c(4964),e=c(3953),m=c(467),f=c(8079);let p=(()=>{var r;class l{constructor(o){this.firestore=o}addData(o,t){var i=this;return(0,m.A)(function*(){return yield i.firestore.collection(o).add(t)})()}getData(o){return this.firestore.collection(o).valueChanges({idField:"id"})}updateData(o,t,i){var s=this;return(0,m.A)(function*(){return yield s.firestore.collection(o).doc(t).set(i,{merge:!0})})()}deleteData(o,t){var i=this;return(0,m.A)(function*(){return yield i.firestore.collection(o).doc(t).delete()})()}}return(r=l).\u0275fac=function(o){return new(o||r)(e.KVO(f.Qe))},r.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"}),l})();var h=c(1182);function v(r,l){if(1&r){const n=e.RV6();e.j41(0,"ion-button",19),e.bIt("click",function(){e.eBV(n);const t=e.XpG().$implicit,i=e.XpG();return e.Njj(i.eliminaAlunno(t.id))}),e.EFF(1,"X"),e.k0s()}}function F(r,l){if(1&r){const n=e.RV6();e.j41(0,"div",2)(1,"ion-row",3)(2,"ion-col",4)(3,"ion-input",5),e.mxI("ngModelChange",function(t){const i=e.eBV(n).$implicit;return e.DH7(i.modifiedNome,t)||(i.modifiedNome=t),e.Njj(t)}),e.bIt("ngModelChange",function(){const t=e.eBV(n).$implicit,i=e.XpG();return e.Njj(i.checkNameChange(t))}),e.k0s(),e.j41(4,"ion-button",6),e.bIt("click",function(){const t=e.eBV(n).$implicit,i=e.XpG();return e.Njj(i.salvaNome(t))}),e.EFF(5,"Salva nome"),e.k0s(),e.DNE(6,v,2,0,"ion-button",7),e.k0s(),e.j41(7,"ion-col",8)(8,"ion-input",9),e.mxI("ngModelChange",function(t){const i=e.eBV(n).$implicit,s=e.XpG();return e.DH7(s.oreDaDedurre[i.nome],t)||(s.oreDaDedurre[i.nome]=t),e.Njj(t)}),e.bIt("focus",function(){const t=e.eBV(n).$implicit,i=e.XpG();return e.Njj(i.resetInput(i.oreDaDedurre,t.nome))}),e.k0s(),e.j41(9,"ion-button",6),e.bIt("click",function(){const t=e.eBV(n).$implicit,i=e.XpG();return e.Njj(i.deduciOre(t))}),e.EFF(10,"Scala Ore"),e.k0s()(),e.j41(11,"ion-col",8)(12,"ion-input",10),e.mxI("ngModelChange",function(t){const i=e.eBV(n).$implicit,s=e.XpG();return e.DH7(s.oreDaAggiungere[i.nome],t)||(s.oreDaAggiungere[i.nome]=t),e.Njj(t)}),e.bIt("focus",function(){const t=e.eBV(n).$implicit,i=e.XpG();return e.Njj(i.resetInput(i.oreDaAggiungere,t.nome))}),e.k0s(),e.j41(13,"ion-button",6),e.bIt("click",function(){const t=e.eBV(n).$implicit,i=e.XpG();return e.Njj(i.incrementaOre(t))}),e.EFF(14,"Aggiungi Ore"),e.k0s()(),e.j41(15,"ion-col",4)(16,"div",11),e.nrm(17,"ion-progress-bar",12),e.j41(18,"span",13),e.EFF(19),e.k0s()()()(),e.j41(20,"ion-row")(21,"div",14)(22,"ion-col",8)(23,"ion-input",15),e.mxI("ngModelChange",function(t){const i=e.eBV(n).$implicit;return e.DH7(i.modifiedOreTotali,t)||(i.modifiedOreTotali=t),e.Njj(t)}),e.k0s(),e.j41(24,"ion-button",6),e.bIt("click",function(){const t=e.eBV(n).$implicit,i=e.XpG();return e.Njj(i.modificaOreTotali(t))}),e.EFF(25,"Salva Ore Totali"),e.k0s()(),e.j41(26,"ion-col",8)(27,"ion-badge",16),e.EFF(28),e.k0s(),e.j41(29,"ion-button",17),e.bIt("click",function(){const t=e.eBV(n).$implicit,i=e.XpG();return e.Njj(i.resetOreFatte(t))}),e.EFF(30,"Reset Ore Fatte"),e.k0s()(),e.j41(31,"ion-col",8)(32,"ion-badge",18),e.EFF(33),e.k0s(),e.j41(34,"ion-button",17),e.bIt("click",function(){const t=e.eBV(n).$implicit,i=e.XpG();return e.Njj(i.resetOreTotali(t))}),e.EFF(35,"Reset Ore Totali"),e.k0s()()()(),e.nrm(36,"ion-item-divider"),e.k0s()}if(2&r){const n=l.$implicit,o=e.XpG();e.R7$(3),e.R50("ngModel",n.modifiedNome),e.Y8G("placeholder",n.nome),e.R7$(),e.Y8G("disabled",!n.isNameModified),e.R7$(2),e.Y8G("ngIf",n.id),e.R7$(2),e.R50("ngModel",o.oreDaDedurre[n.nome]),e.R7$(),e.Y8G("disabled",!o.oreDaDedurre[n.nome]),e.R7$(3),e.R50("ngModel",o.oreDaAggiungere[n.nome]),e.R7$(),e.Y8G("disabled",!o.checkOreChange(n)),e.R7$(4),e.Y8G("value",o.getOreFatteProgresso(n)),e.R7$(2),e.SpI(" ",o.getPercentualeMancante(n),"% "),e.R7$(4),e.R50("ngModel",n.modifiedOreTotali),e.Y8G("placeholder",n.oreTotali.toString()),e.R7$(),e.Y8G("disabled",!o.isOreTotaliModified(n)),e.R7$(4),e.SpI("Ore fatte: ",n.oreFatte,""),e.R7$(5),e.SpI("Ore mancanti: ",n.oreTotali-n.oreFatte,"")}}const T=[{path:"",component:(()=>{var r;class l{constructor(o,t){this.firestoreService=o,this.afAuth=t,this.bambini=[{id:"1",nome:"Nome",oreTotali:0,oreFatte:0,modifiedNome:"Nome",modifiedOreTotali:null,isNameModified:!1}],this.oreDaAggiungere={},this.oreDaDedurre={}}ngOnInit(){this.afAuth.authState.subscribe(o=>{o?this.loadBambini():console.log("Utente non autenticato")})}loadBambini(){this.firestoreService.getData("alunni").subscribe(o=>{this.bambini=o.map(t=>({id:t.id,...t}))})}creaNuovoAlunno(){this.firestoreService.addData("alunni",{nome:"Nuovo Bambino",oreTotali:0,oreFatte:0,modifiedNome:"",modifiedOreTotali:null,isNameModified:!1}).then(()=>{console.log("Nuovo alunno creato con successo!"),this.loadBambini()}).catch(t=>console.error("Errore nella creazione del nuovo alunno: ",t))}eliminaAlunno(o){confirm("Sei sicuro di voler eliminare questo alunno?")?this.firestoreService.deleteData("alunni",o).then(()=>console.log("Alunno eliminato con successo!")).catch(i=>console.error("Errore nell'eliminazione dell'alunno: ",i)):console.log("Eliminazione annullata.")}incrementaOre(o){const t=Number(this.oreDaAggiungere[o.nome])||0;t>0&&(o.oreTotali+=t,this.oreDaAggiungere[o.nome]="",this.saveBambino(o))}deduciOre(o){const t=Number(this.oreDaDedurre[o.nome])||0;t>0&&(o.oreFatte+=t,this.oreDaDedurre[o.nome]="",this.saveBambino(o))}saveBambino(o){console.log("Salvando bambino con ID:",o.id),o.id?this.firestoreService.updateData("alunni",o.id,{nome:o.nome,oreFatte:o.oreFatte,oreTotali:o.oreTotali,modifiedNome:o.modifiedNome,modifiedOreTotali:o.modifiedOreTotali,isNameModified:o.isNameModified}).then(()=>console.log("Documento aggiornato con successo!")).catch(i=>console.error("Errore nell'aggiornamento del documento: ",i)):console.error("ID non definito per il bambino:",o)}modificaOreTotali(o){if(null!==o.modifiedOreTotali){const t=Number(o.modifiedOreTotali);t<o.oreFatte?(o.oreTotali=t,o.oreFatte=Math.min(o.oreFatte,t)):o.oreTotali=t,o.modifiedOreTotali=null,this.saveBambino(o)}}resetInput(o,t){o[t]=""}checkNameChange(o){o.isNameModified=o.modifiedNome!==o.nome}salvaNome(o){o.isNameModified&&(o.nome=o.modifiedNome,o.isNameModified=!1,this.saveBambino(o))}checkOreChange(o){return Number(this.oreDaAggiungere[o.nome])>0}getOreFatteProgresso(o){return Math.max(0,o.oreTotali-o.oreFatte)/Math.max(o.oreTotali,1)}isOreTotaliModified(o){return null!==o.modifiedOreTotali&&o.modifiedOreTotali!==o.oreTotali}resetOreFatte(o){confirm(`Sei sicuro di voler resettare le ore fatte per ${o.nome}?`)&&(o.oreFatte=0,this.saveBambino(o))}resetOreTotali(o){confirm(`Sei sicuro di voler resettare le ore totali per ${o.nome}?`)&&(o.oreTotali=0,o.oreFatte=Math.min(o.oreFatte,o.oreTotali),this.saveBambino(o))}getPercentualeMancante(o){return Math.round((o.oreTotali-o.oreFatte)/Math.max(o.oreTotali,1)*100)}}return(r=l).\u0275fac=function(o){return new(o||r)(e.rXU(p),e.rXU(h.DS))},r.\u0275cmp=e.VBU({type:r,selectors:[["app-home"]],decls:13,vars:1,consts:[["expand","full",3,"click"],["class","nome-container","style","margin-bottom: 30px;",4,"ngFor","ngForOf"],[1,"nome-container",2,"margin-bottom","30px"],[2,"width","100%"],["size-xs","12","size-sm","12","size-md","12","size-l","12","size-xl","12",2,"display","flex","align-items","center","justify-content","space-around"],["type","text",2,"width","120px","margin","5px",3,"ngModelChange","ngModel","placeholder"],[3,"click","disabled"],["color","danger",3,"click",4,"ngIf"],["size-xs","12","size-sm","12","size-md","5.5","size-l","2.5","size-xl","2.5",2,"display","flex","align-items","center","margin-right","10px","justify-content","space-around"],["type","number","placeholder","Ore da scalare",2,"width","120px","background-color","aliceblue","margin","5px",3,"ngModelChange","focus","ngModel"],["type","number","placeholder","Ore da aggiungere",2,"width","120px","background-color","aliceblue","margin","5px",3,"ngModelChange","focus","ngModel"],[2,"position","relative","width","100%"],[2,"margin-top","10px","height","20px",3,"value"],[2,"position","absolute","width","100%","text-align","center","top","9px","left","0","color","white"],[2,"display","flex","align-items","center","justify-content","space-around","width","100%","flex-flow","wrap"],["type","number",2,"width","120px","background-color","aliceblue","margin","5px",3,"ngModelChange","ngModel","placeholder"],[2,"min-width","auto","height","30px","background-color","green","display","flex","align-items","center","justify-content","center","font-size","large"],[3,"click"],[2,"min-width","auto","height","30px","background-color","darkred","display","flex","align-items","center","justify-content","center","font-size","large"],["color","danger",3,"click"]],template:function(o,t){1&o&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"Conteggio Ore"),e.k0s()()(),e.j41(4,"ion-content")(5,"ion-card")(6,"ion-card-header")(7,"ion-card-title"),e.EFF(8,"Ore Rimanenti per i Ragazzi"),e.k0s()(),e.j41(9,"ion-card-content")(10,"ion-button",0),e.bIt("click",function(){return t.creaNuovoAlunno()}),e.EFF(11,"Crea Nuovo Alunno"),e.k0s(),e.DNE(12,F,37,15,"div",1),e.k0s()()()),2&o&&(e.R7$(12),e.Y8G("ngForOf",t.bambini))},dependencies:[d.Sq,d.bT,u.BC,u.vS,a.In,a.Jm,a.b_,a.I9,a.ME,a.tN,a.hU,a.W9,a.eU,a.$w,a.Dg,a.FH,a.ln,a.BC,a.ai,a.su,a.Gw],styles:[".nome-container[_ngcontent-%COMP%]{margin:10px 0}ion-badge[_ngcontent-%COMP%]{background-color:gray}"]}),l})()}];let j=(()=>{var r;class l{}return(r=l).\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.$C({type:r}),r.\u0275inj=e.G2t({imports:[_.iI.forChild(T),_.iI]}),l})(),M=(()=>{var r;class l{}return(r=l).\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.$C({type:r}),r.\u0275inj=e.G2t({imports:[d.MD,u.YN,a.bv,j]}),l})()}}]);